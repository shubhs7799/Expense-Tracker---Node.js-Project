<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Forgot Password - Expense Tracker</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container auth-container">
    <div style="text-align: center; margin-bottom: 2rem;">
      <div style="font-size: 3rem; margin-bottom: 0.5rem;">ðŸ”‘</div>
      <h2>Forgot Password?</h2>
      <p style="color: #7f8c8d; margin-bottom: 2rem;">No worries! Enter your email and we'll send you a reset link</p>
    </div>
    
    <form id="forgotPasswordForm">
      <div style="position: relative;">
        <input type="email" id="resetEmail" placeholder="   Enter your email address" required style="padding-left: 45px;" />
        <span style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #95a5a6;">ðŸ“§</span>
      </div>
      
      <button type="submit">
        <span>Send Reset Link</span>
      </button>
      
      <div style="text-align: center; margin-top: 1.5rem;">
        <p style="color: #7f8c8d;">Remember your password? 
          <a href="login.html" style="font-weight: 600;">Sign in here</a>
        </p>
      </div>
    </form>
    
    <div class="error" id="forgotPasswordError" style="display: none;"></div>
    <div class="success" id="forgotPasswordSuccess" style="display: none; background: rgba(39, 174, 96, 0.1); color: #27ae60; padding: 10px; border-radius: 8px; border-left: 4px solid #27ae60; margin-top: 10px;"></div>
  </div>

  <script>
    const baseURL = '/api/v1';

    function showError(message) {
      const errorElement = document.getElementById('forgotPasswordError');
      errorElement.textContent = message;
      errorElement.style.display = 'block';
      document.getElementById('forgotPasswordSuccess').style.display = 'none';
      setTimeout(() => {
        errorElement.style.display = 'none';
      }, 5000);
    }

    function showSuccess(message) {
      const successElement = document.getElementById('forgotPasswordSuccess');
      successElement.textContent = message;
      successElement.style.display = 'block';
      document.getElementById('forgotPasswordError').style.display = 'none';
    }

    const forgotPasswordForm = document.getElementById('forgotPasswordForm');
    if (forgotPasswordForm) {
      forgotPasswordForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('resetEmail').value.trim();

        const submitBtn = forgotPasswordForm.querySelector('button[type="submit"]');
        const originalText = submitBtn.innerHTML;

        try {
          submitBtn.innerHTML = '<div class="loading"></div> Sending...';
          submitBtn.disabled = true;

          const res = await fetch(`${baseURL}/forgot-password`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email }),
          });

          const data = await res.json();
          
          if (res.ok) {
            showSuccess(data.message);
            forgotPasswordForm.reset();
          } else {
            throw new Error(data.message);
          }

        } catch (err) {
          showError(err.message);
        } finally {
          submitBtn.innerHTML = originalText;
          submitBtn.disabled = false;
        }
      });
    }
  </script>
</body>
</html>
